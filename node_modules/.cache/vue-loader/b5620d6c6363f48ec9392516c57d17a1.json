{"remainingRequest":"/Users/robert/project/vue/UniversalVue/UniversalVue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/robert/project/vue/UniversalVue/UniversalVue/src/views/sys/oss/oss-upload.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/robert/project/vue/UniversalVue/UniversalVue/src/views/sys/oss/oss-upload.vue","mtime":1584947585009},{"path":"/Users/robert/project/vue/UniversalVue/UniversalVue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/robert/project/vue/UniversalVue/UniversalVue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/robert/project/vue/UniversalVue/UniversalVue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/robert/project/vue/UniversalVue/UniversalVue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { getToken } from \"@/utils/auth\";\nexport default {\n  data() {\n    return {\n      visible: false,\n      url: \"\",\n      num: 0,\n      successNum: 0,\n      fileList: []\n    };\n  },\n  methods: {\n    init(id) {\n      this.url = `/api/sys/oss/upload?token=${getToken()}`;\n      this.visible = true;\n    },\n    // 上传之前\n    beforeUploadHandle(file) {\n      if (\n        file.type !== \"image/jpg\" &&\n        file.type !== \"image/jpeg\" &&\n        file.type !== \"image/png\" &&\n        file.type !== \"image/gif\"\n      ) {\n        this.$message.error(\"只支持jpg、png、gif格式的图片！\");\n        return false;\n      }\n      this.num++;\n    },\n    // 上传成功\n    successHandle(response, file, fileList) {\n      this.fileList = fileList;\n      this.successNum++;\n      if (response && response.code === 0) {\n        if (this.num === this.successNum) {\n          this.$confirm(\"操作成功, 是否继续操作?\", \"提示\", {\n            confirmButtonText: \"确定\",\n            cancelButtonText: \"取消\",\n            type: \"warning\"\n          }).catch(() => {\n            this.visible = false;\n          });\n        }\n      } else {\n        this.$message.error(response.msg);\n      }\n    },\n    // 弹窗关闭时\n    closeHandle() {\n      this.fileList = [];\n      this.$emit(\"refreshDataList\");\n    }\n  }\n};\n",{"version":3,"sources":["oss-upload.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"oss-upload.vue","sourceRoot":"src/views/sys/oss","sourcesContent":["<template>\n  <el-dialog\n    title=\"上传文件\"\n    :close-on-click-modal=\"false\"\n    @close=\"closeHandle\"\n    :visible.sync=\"visible\">\n    <el-upload\n      drag\n      :action=\"url\"\n      :before-upload=\"beforeUploadHandle\"\n      :on-success=\"successHandle\"\n      multiple\n      :file-list=\"fileList\"\n      style=\"text-align: center;\">\n      <i class=\"el-icon-upload\"></i>\n      <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\n      <div class=\"el-upload__tip\" slot=\"tip\">只支持jpg、png、gif格式的图片！</div>\n    </el-upload>\n  </el-dialog>\n</template>\n\n<script>\nimport { getToken } from \"@/utils/auth\";\nexport default {\n  data() {\n    return {\n      visible: false,\n      url: \"\",\n      num: 0,\n      successNum: 0,\n      fileList: []\n    };\n  },\n  methods: {\n    init(id) {\n      this.url = `/api/sys/oss/upload?token=${getToken()}`;\n      this.visible = true;\n    },\n    // 上传之前\n    beforeUploadHandle(file) {\n      if (\n        file.type !== \"image/jpg\" &&\n        file.type !== \"image/jpeg\" &&\n        file.type !== \"image/png\" &&\n        file.type !== \"image/gif\"\n      ) {\n        this.$message.error(\"只支持jpg、png、gif格式的图片！\");\n        return false;\n      }\n      this.num++;\n    },\n    // 上传成功\n    successHandle(response, file, fileList) {\n      this.fileList = fileList;\n      this.successNum++;\n      if (response && response.code === 0) {\n        if (this.num === this.successNum) {\n          this.$confirm(\"操作成功, 是否继续操作?\", \"提示\", {\n            confirmButtonText: \"确定\",\n            cancelButtonText: \"取消\",\n            type: \"warning\"\n          }).catch(() => {\n            this.visible = false;\n          });\n        }\n      } else {\n        this.$message.error(response.msg);\n      }\n    },\n    // 弹窗关闭时\n    closeHandle() {\n      this.fileList = [];\n      this.$emit(\"refreshDataList\");\n    }\n  }\n};\n</script>\n"]}]}