{"remainingRequest":"/Users/robert/project/vue/UniversalVue/UniversalVue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/robert/project/vue/UniversalVue/UniversalVue/src/views/sys/role/components/role-add-or-update.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/robert/project/vue/UniversalVue/UniversalVue/src/views/sys/role/components/role-add-or-update.vue","mtime":1584947585010},{"path":"/Users/robert/project/vue/UniversalVue/UniversalVue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/robert/project/vue/UniversalVue/UniversalVue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/robert/project/vue/UniversalVue/UniversalVue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/robert/project/vue/UniversalVue/UniversalVue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { treeDataTranslate } from \"@/utils\";\nimport { menuList, roleDataFormSubmit, roleInfo } from \"@/api/sys\";\nimport SidesLip from \"@/components/SidesLip\";\nexport default {\n  data() {\n    return {\n      loading: false,\n      visible: false,\n      menuList: [],\n      menuListTreeProps: {\n        label: \"name\",\n        children: \"children\"\n      },\n      dataForm: {\n        id: 0,\n        roleName: \"\",\n        remark: \"\"\n      },\n      dataRule: {\n        roleName: [\n          { required: true, message: \"角色名称不能为空\", trigger: \"blur\" }\n        ]\n      }\n    };\n  },\n  components: {\n    SidesLip\n  },\n  methods: {\n    async init(id) {\n      this.dataForm.id = id || 0;\n      const { data } = await menuList();\n      this.menuList = treeDataTranslate(data, \"menuId\");\n      this.$refs.SidesLip.init(this.dataForm.id?\"修改\":\"新增\", \"700px\", \"block\");\n      await this.$nextTick(() => {\n        this.$refs[\"dataForm\"].resetFields();\n        this.$refs.menuListTree.setCheckedKeys([]);\n      });\n      if (this.dataForm.id) {\n        const { data } = await roleInfo(`/sys/role/info/${this.dataForm.id}`);\n        if (data && data.code === 0) {\n          this.dataForm.roleName = data.role.roleName;\n          this.dataForm.remark = data.role.remark;\n          this.$refs.menuListTree.setCheckedKeys(data.role.menuIdList);\n        }\n      }\n    },\n    sideClose() {\n      this.$refs.SidesLip.sideClose();\n    },\n    // 表单提交\n    dataFormSubmit() {\n      this.$refs[\"dataForm\"].validate(async valid => {\n        if (valid) {\n          const params = {\n            roleId: this.dataForm.id || undefined,\n            roleName: this.dataForm.roleName,\n            remark: this.dataForm.remark,\n            menuIdList: [].concat(\n              this.$refs.menuListTree.getCheckedKeys(),\n              this.$refs.menuListTree.getHalfCheckedKeys()\n            )\n          };\n          const { data } = await roleDataFormSubmit(\n            `/sys/role/${!this.dataForm.id ? \"save\" : \"update\"}`,\n            params\n          );\n          if (data && data.code === 0) {\n            this.$message({\n              message: \"操作成功\",\n              type: \"success\",\n              duration: 1500,\n              onClose: () => {\n                this.sideClose();\n                this.$emit(\"refreshDataList\");\n              }\n            });\n          } else {\n            this.$message.error(data.msg);\n          }\n        }\n      });\n    }\n  }\n};\n",{"version":3,"sources":["role-add-or-update.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"role-add-or-update.vue","sourceRoot":"src/views/sys/role/components","sourcesContent":["<template>\n    <sides-lip ref=\"SidesLip\">\n        <div slot=\"soltForm\">\n      <el-form :model=\"dataForm\" :rules=\"dataRule\" ref=\"dataForm\" @keyup.enter.native=\"dataFormSubmit()\" label-width=\"80px\" size=\"small\">\n        <el-form-item label=\"角色名称\" prop=\"roleName\">\n          <el-input v-model=\"dataForm.roleName\" placeholder=\"角色名称\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"备注\" prop=\"remark\">\n          <el-input v-model=\"dataForm.remark\" placeholder=\"备注\"></el-input>\n        </el-form-item>\n        <el-form-item size=\"mini\" label=\"授权\">\n          <el-tree\n            :data=\"menuList\"\n            :props=\"menuListTreeProps\"\n            node-key=\"menuId\"\n            ref=\"menuListTree\"\n            :default-expand-all=\"true\"\n            show-checkbox>\n          </el-tree>\n        </el-form-item>\n      </el-form>\n      </div>\n      <div slot=\"soltFooter\">\n        <el-button @click=\"sideClose\" size=\"small\">取消</el-button>\n        <el-button type=\"primary\" :loading=\"loading\" @click=\"dataFormSubmit()\" size=\"small\">确定</el-button>\n      </div>\n    </sides-lip>\n</template>\n\n<script>\nimport { treeDataTranslate } from \"@/utils\";\nimport { menuList, roleDataFormSubmit, roleInfo } from \"@/api/sys\";\nimport SidesLip from \"@/components/SidesLip\";\nexport default {\n  data() {\n    return {\n      loading: false,\n      visible: false,\n      menuList: [],\n      menuListTreeProps: {\n        label: \"name\",\n        children: \"children\"\n      },\n      dataForm: {\n        id: 0,\n        roleName: \"\",\n        remark: \"\"\n      },\n      dataRule: {\n        roleName: [\n          { required: true, message: \"角色名称不能为空\", trigger: \"blur\" }\n        ]\n      }\n    };\n  },\n  components: {\n    SidesLip\n  },\n  methods: {\n    async init(id) {\n      this.dataForm.id = id || 0;\n      const { data } = await menuList();\n      this.menuList = treeDataTranslate(data, \"menuId\");\n      this.$refs.SidesLip.init(this.dataForm.id?\"修改\":\"新增\", \"700px\", \"block\");\n      await this.$nextTick(() => {\n        this.$refs[\"dataForm\"].resetFields();\n        this.$refs.menuListTree.setCheckedKeys([]);\n      });\n      if (this.dataForm.id) {\n        const { data } = await roleInfo(`/sys/role/info/${this.dataForm.id}`);\n        if (data && data.code === 0) {\n          this.dataForm.roleName = data.role.roleName;\n          this.dataForm.remark = data.role.remark;\n          this.$refs.menuListTree.setCheckedKeys(data.role.menuIdList);\n        }\n      }\n    },\n    sideClose() {\n      this.$refs.SidesLip.sideClose();\n    },\n    // 表单提交\n    dataFormSubmit() {\n      this.$refs[\"dataForm\"].validate(async valid => {\n        if (valid) {\n          const params = {\n            roleId: this.dataForm.id || undefined,\n            roleName: this.dataForm.roleName,\n            remark: this.dataForm.remark,\n            menuIdList: [].concat(\n              this.$refs.menuListTree.getCheckedKeys(),\n              this.$refs.menuListTree.getHalfCheckedKeys()\n            )\n          };\n          const { data } = await roleDataFormSubmit(\n            `/sys/role/${!this.dataForm.id ? \"save\" : \"update\"}`,\n            params\n          );\n          if (data && data.code === 0) {\n            this.$message({\n              message: \"操作成功\",\n              type: \"success\",\n              duration: 1500,\n              onClose: () => {\n                this.sideClose();\n                this.$emit(\"refreshDataList\");\n              }\n            });\n          } else {\n            this.$message.error(data.msg);\n          }\n        }\n      });\n    }\n  }\n};\n</script>\n"]}]}